var streamInterval,end,streamLoadUrl;$(document).ready(function(){if(!Modernizr.input.placeholder){$("[placeholder]").focus(function(){var g=$(this);if(g.val()==g.attr("placeholder")){g.val("");g.removeClass("placeholder")}}).blur(function(){var g=$(this);if(g.val()==""||g.val()==g.attr("placeholder")){g.addClass("placeholder");g.val(g.attr("placeholder"))}}).blur();$("[placeholder]").parents("form").submit(function(){$(this).find("[placeholder]").each(function(){var g=$(this);if(g.val()==g.attr("placeholder")){g.val("")}})})}$("#discussions").accordion({collapsible:true,active:false,autoHeight:false,header:"a.header",});$(".load_more").click(function(g){offset=$(this).attr("data-offset");url=$(this).attr("data-url")+"daily_mag/ajax_get_"+$(this).attr("id")+"s/"+offset;$(this).attr("data-offset",parseInt(offset)+5);$.get(url,function(h){$("#discussions").children(".load_more").before(h);$("#discussions").accordion("destroy");$("#discussions").accordion({collapsible:true,active:false,autoHeight:false,header:"a.header",})});g.preventDefault()});$("#notification-count").click(function(){$("#notif-dropdown").fadeToggle(150)});$("#dropdown-link").click(function(){$(this).siblings().fadeToggle(150);if($(this).attr("class")!="selected"){$(this).addClass("selected")}else{$(this).removeClass("selected")}});$("#attach-link").click(function(){$(this).hide();$("#attachment").show()});$("#post-text").click(function(){$(this).css("border-bottom-color","#ddd").css("color","#444").elastic().siblings(".hidden").removeClass("hidden").hide().fadeIn(150)});$(document).delegate(".comment_text","click",function(){$(this).elastic()});$("#add-button").click(function(){$("#filter_panel").fadeToggle("fast");$("<div id=blackout>").appendTo("html")});$(document).delegate("#blackout","click",function(){$("#filter_panel").fadeOut("fast");$("#blackout").fadeOut("fast",function(){$("#blackout").remove()})});$(document).delegate(".stream_object","mouseover mouseout",function(g){if(g.type=="mouseover"){$(".edit",this).css("display","inline-block");$(".remove",this).show()}else{$(".edit",this).hide();$(".remove",this).hide()}});$(document).delegate(".smile-vote","click",function(){$(this).siblings(".smile-vote-container").fadeToggle(150)});$(document).delegate(".smile-vote-options","click",function(){$(this).parent().fadeOut(150)});$("#load-more").click(function(){var g=parseInt($(this).attr("data-offset"));$("<div>").load(streamLoadUrl+"/"+g,function(){if($(this).html()==""){return}$(this).hide();$("#stream-list").append($(this));$(this).fadeIn("slow");$("#load-more").attr("data-offset",g+10);clearInterval(streamInterval)})});$(".tag_suggestion").click(function(h){var g=$(this).parent().siblings("#post-tags").val();if(g==""){$(this).parent().siblings("#post-tags").val($(this).html())}else{$(this).parent().siblings("#post-tags").val(g+", "+$(this).html())}h.preventDefault()});var a=["code","design","doc","funny","gaming","link","pic","question","school","science","technology","video"];var d=[8,9,13,16,17,20,27,32,33,34,35,36,37,38,39,40,46];var e=false;var c=false;for(i=48;i<106;i++){d.push(i)}function b(g){return g.split(/ \s*/)}function f(g){return b(g).pop()}$("#new-filter-title").bind("keydown",function(g){if(($.inArray(g.keyCode,d)==-1&&!e)||(c&&$.inArray(g.keyCode,[48,49,50,51,52,53,54,55,56,57])>-1&&!e)){$("<img src='img/bad_char.gif' id=bad-char-flag-filter />").appendTo($("#filter_panel")).hide().fadeIn("fast");e=true}else{if(g.keyCode==8&&e){$("#bad-char-flag-filter").fadeOut("fast").delay(100).remove();e=false;c=false}else{if(g.keyCode==16&&!c){c=true}else{if(c){c=false}}}}});$("#post-tags").bind("keydown",function(g){if(g.keyCode===$.ui.keyCode.TAB&&$(this).data("autocomplete").menu.active){g.preventDefault()}if(($.inArray(g.keyCode,d)==-1&&!e)||(c&&$.inArray(g.keyCode,[48,49,50,51,52,53,54,55,56,57])>-1&&!e)){$("<img src='img/bad_char.gif' id=bad-char-flag />").appendTo($("#write_block")).hide().fadeIn("fast");e=true}else{if(g.keyCode==8&&e){$("#bad-char-flag").fadeOut("fast").delay(100).remove();e=false;c=false}else{if(g.keyCode==16&&!c){c=true}else{if(c){c=false}}}}}).autocomplete({minLength:0,source:function(h,g){g($.ui.autocomplete.filter(a,f(h.term)))},focus:function(g,h){return false},select:function(h,j){var g=b(this.value);g.pop();g.push(j.item.value);g.push("");this.value=g.join(" ");return false},open:function(){$(".ui-autocomplete").prepend($("<li class='ui-menu-item-disabled'><p class='info'>Type a new tag or choose from the list below. Separate multiple tags with a space.</p></li>"))}}).focus(function(){if(this.value==""){$(this).trigger("keydown.autocomplete")}});$("#stream-settings-btn").click(function(){$(this).siblings().toggle()})});function sub(b,d,e,a,c){if(!d.hasClass("clicked")){$.post(b,{action:e,o:a,f:c},function(f){switch(parseInt(f)){case 0:d.addClass("btn-success clicked").html(e.charAt(0).toUpperCase()+e.slice(1)+"scribed!");break;default:d.addClass("btn-failure").html(e.charAt(0).toUpperCase()+e.slice(1)+"scription failed!");break}})}}function run_stream_ajax(a){}function run_tag_js(a){$(document).delegate(".edit","click",function(){pause_stream();var f=new Array(),d="",c=$(this).siblings(".name").html(),b="";$(this).siblings(".tag").each(function(){f.push($(this).html())});for(var e=0;e<f.length-1;e++){d+=f[e]+" "}d+=f[f.length-1];if(d=="undefined"){d=""}b+="<input type='text' name='tag_edit' id='tag_edit' value='"+d+"' />";b+="<span class='small'>&crarr; Enter to save.</span>";$(this).parentsUntil(".post_main").html(b);$("#tag_edit").focus();$("#tag_edit").bind("keypress",function(h){var g=(h.keyCode?h.keyCode:h.which);if(g==13){$.ajax({url:a,type:"POST",context:$(this).parent(),data:{new_tags:$("#tag_edit").val(),id:$(this).parentsUntil("stream_object").siblings(".post_id").html()},success:function(j){$(this).html(j+"<input type='button' value='+ edit' class='tag edit' />");play_stream()}})}});$("#tag_edit").focusout(function(){$.ajax({url:a,type:"POST",context:$(this).parent(),data:{new_tags:$("#tag_edit").val(),id:$(this).parentsUntil("stream_object").siblings(".post_id").html()},success:function(g){$(this).html(g+"<input type='button' value='+ edit' class='tag edit' />");play_stream()}})})})}function pause_stream(){clearInterval(streamInterval)}function play_stream(){streamInterval=setInterval(function(){$("#stream-list").load(streamLoadUrl)},10000)}function refresh_stream(){pause_stream();$("#stream-list").load(streamLoadUrl);play_stream()};